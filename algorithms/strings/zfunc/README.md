## Z-функция

Пусть дана строка $s$ длины $n$. Тогда Тогда **Z-функция** от этой строки — это массив длины $n$, $i$-ый элемент которого равен наибольшему числу символов, начиная с позиции $i$, совпадающих с первыми символами строки $s$.

Иными словами, $z_i$ — это длина наибольшего общего префикса строки $s$ и её $i$-го суффикса.

Первый элемент Z-функции, $z_0$, обычно считают неопределённым, и, хотя ни в алгоритме, ни в приведённой реализации это ничего не меняет, мы положим элемент $z_0$ равным нулю.

## Описание алгоритма

Тривиальный алгоритм вычисления Z-функции имеет асимптотику $O(n^2)$ и реализуется простым перебором:

```
for (int i = 0; i < s.length(); ++i)
    while (i + z[i] < n && s[z[i]] == s[i + z[i]])
        z[i]++;
```

Реализация, приведенная в данном репозитории является улучшенной и работает за $O(n)$. Чтобы получить эффективный алгоритм, будем вычислять значения $z_i$ по очереди  от $i = 1$ до $n - 1$, при этом используя ранее полученные значения.

Будем поддерживать координаты $[l, r]$ отрезка, совпадающего с некоторым префиксом и оканчивающегося правее всего. В некотором смысле, координата $r$ — это такая граница, до которой наша строка уже была просканирована алгоритмом, а всё остальное — пока ещё не известно.

В зависимости от позиций границы $r$ и текущего индекса $i$, получаем два возможных варианта:
- $i \le r$, или текущая позиция лежит внутри отслеживаемого отрезка. Заметим, что подстроки $s_{l..r}$ и $s_{0..r-l}$ совпадают, то есть для начального приближения для $z_i$ можно взять соответствующее ему значение из отрезка $s_{0..r-l}$, а именно $z_{i-l}$. Однако, стоит заметить также, что мы не можем таким образом выходить за границу текущего отрезка, поскольку дальше индекса $r$ ничего не известно о строке. В таком случае получаем соответствующую формулу: $z_i = min(r - i + 1, \ z_{i - l})$.
- $i > r$, или текущая позиция лежит правее отслеживаемого отрезка. В этом случае будем просто искать значение $z_i$ с помощью тривиального алгоритма. В этом же случае, если $z_i$ окажется не нулевым, необходимо будет обновить границы отслеживаемого отрезка, поскольку $i + z_i - 1$ гарантированно окажется больше $r$.
